<!DOCTYPE html>
<html>
<head>
	<link href={{ url_for('static', filename='../styles/view21.css') }} rel="stylesheet"/>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<!-- <script rel = "stylesheet" src = "../scripts/view3.js"></script> -->
<script>
$(document).ready(function() { 
		$('#hi1').on('submit',function(event) { 
			$.ajax({
			data : {
				userid : $('#id11').val(),
				count1 : $('#count11').val(),
				postid : $('#post11').val()
			},
			type : 'POST',
			url : '/vote'
		})
		.done(function(data) {

			if (data.error) {
				alert("You have alreday voted.")
			}
			else {
				$("#vote00").text(data.count);
			}
		});

		event.preventDefault();
	}); 
		$('#hi2').on('submit',function(event) { 
			$.ajax({
			data : {
				userid : $('#id22').val(),
				count1 : $('#count22').val(),
				postid : $('#post22').val()
			},
			type : 'POST',
			url : '/vote'
		})
		.done(function(data) {

			if (data.error) {
				alert("You have alreday voted.")
			}
			else {
				$("#vote00").text(data.count);
			}
		});

		event.preventDefault();
	});
}); 
</script>
<!-- <style> -->
<!-- table { -->
  <!-- font-family: arial, sans-serif; -->
  <!-- border-collapse: collapse; -->
  <!-- width: 100%; -->
<!-- } -->

<!-- td, th { -->
  <!-- border: 1px solid #dddddd; -->
  <!-- text-align: left; -->
  <!-- padding: 8px; -->
  <!-- width: 50%; -->
<!-- } -->

<!-- tr:nth-child(even) { -->
  <!-- background-color: #dddddd; -->
<!-- } -->
<!-- </style> -->
</head>
<body>
<br>
<h2>Profile Page</h2>
<a href="/{{hashedcode}}/create">Create New post</a>
<br><br>

<table>
  <tr>
	<th>Title</th>
    <th>Content</th>
	<th>Vote Count</th>
	<th>Vote</th>
  </tr>
{% for key,value in data.items() %}
  
  <tr>
    <td><a href="/posts/{{key[1]}}/{{hashedcode}}">{{key[0]}}</td>
    <td>{{value[0]}}</td>
	<td id='vote00'>{{value[1]}}</td>
	<td><form id='hi1' class="form-inline">
		<input type="hidden" id="id11" name="userid" value={{hashedcode}}>
		<input type="hidden" id="post11" name="postid" value={{key[1]}}>
		<input type="hidden" id="count11" name="count1" value=1>
		<button type="submit">Upvote</button></form>
		<form id='hi2' class="form-inline">
		<input type="hidden" id="id22" name="userid" value={{hashedcode}}>
		<input type="hidden" id="post22" name="postid" value={{key[1]}}>
		<input type="hidden" id="count22" name="count1" value=-1>
		<button type="submit">Downvote</button>
	</form></td>
	<!-- <td><a href="/posts/{{key[1]}}">VIEW</a></td> -->
  </tr>
{% endfor %}
</table>

</body>
</html>
